<!DOCTYPE html>
<html lang="en">

  <head>
    <meta charset="UTF-8">
    <title>Val Photobooth</title>
    

  </head>
    
  <body>
  <!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Valentines 2026 ~ Photo Booth</title>
  <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:ital,wght@0,400;0,600;0,700;1,400&family=Outfit:wght@300;400;500;600;700&family=Special+Elite&display=swap" rel="stylesheet">
  <style>
    :root {
      --cream: #FAF7F2;
      --beige: #EDE6DA;
      --warm-beige: #D4C4B0;
      --brown: #5C4033;
      --dark-brown: #3D2914;
      --black: #1A1A1A;
      --rose: #9E5A63;
      --rose-light: #C4848C;
      --rose-dark: #7A4149;
      --film-white: #F5F2EB;
      --gold: #B8997A;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Outfit', sans-serif;
      background: var(--cream);
      min-height: 100vh;
      background-image:
        radial-gradient(ellipse at 20% 20%, rgba(158, 90, 99, 0.03) 0%, transparent 50%),
        radial-gradient(ellipse at 80% 80%, rgba(184, 153, 122, 0.05) 0%, transparent 50%);
    }

    /* Header */
    header {
      text-align: center;
      padding: 50px 20px 40px;
      position: relative;
      overflow: hidden;
    }

    header::before {
      content: 'â™¥';
      position: absolute;
      font-size: 400px;
      color: var(--rose);
      opacity: 0.015;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      pointer-events: none;
    }

    h1 {
      font-family: 'Cormorant Garamond', serif;
      font-size: clamp(42px, 10vw, 72px);
      font-weight: 600;
      color: var(--dark-brown);
      letter-spacing: -2px;
      margin-bottom: 8px;
      position: relative;
    }

    h1 span {
      display: inline-block;
      animation: floatIn 1s ease-out both;
    }

    h1 span:nth-child(1) {
      animation-delay: 0.1s;
    }

    h1 span:nth-child(2) {
      animation-delay: 0.15s;
    }

    h1 span:nth-child(3) {
      animation-delay: 0.2s;
    }

    @keyframes floatIn {
      from {
        opacity: 0;
        transform: translateY(20px);
      }

      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .subtitle {
      font-family: 'Outfit', sans-serif;
      font-size: 12px;
      font-weight: 500;
      color: var(--brown);
      letter-spacing: 6px;
      text-transform: uppercase;
      opacity: 0;
      animation: fadeIn 0.8s ease-out 0.4s forwards;
    }

    @keyframes fadeIn {
      to {
        opacity: 1;
      }
    }

    .header-decoration {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 16px;
      margin-top: 20px;
      opacity: 0;
      animation: fadeIn 0.8s ease-out 0.6s forwards;
    }

    .header-decoration .line {
      width: 60px;
      height: 1px;
      background: linear-gradient(90deg, transparent, var(--warm-beige), transparent);
    }

    .header-decoration .heart {
      color: var(--rose);
      font-size: 10px;
    }

    /* Main container */
    .main-container {
      max-width: 1300px;
      margin: 0 auto;
      padding: 20px 30px 60px;
      display: grid;
      grid-template-columns: 1fr 340px;
      gap: 50px;
    }

    @media (max-width: 1000px) {
      .main-container {
        grid-template-columns: 1fr;
        max-width: 540px;
        padding: 20px 20px 60px;
      }
    }

    /* Photo booth section */
    .booth-section {
      display: flex;
      flex-direction: column;
      align-items: center;
    }

    /* Camera/Upload Selection Tabs */
    .mode-tabs {
      display: flex;
      gap: 0;
      margin-bottom: 24px;
      background: var(--beige);
      border-radius: 50px;
      padding: 5px;
      box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.05);
    }

    .mode-tab {
      padding: 12px 28px;
      font-family: 'Outfit', sans-serif;
      font-size: 13px;
      font-weight: 500;
      letter-spacing: 0.5px;
      color: var(--brown);
      background: transparent;
      border: none;
      border-radius: 50px;
      cursor: pointer;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .mode-tab:hover {
      color: var(--dark-brown);
    }

    .mode-tab.active {
      background: var(--cream);
      color: var(--rose);
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
    }

    .mode-tab svg {
      width: 18px;
      height: 18px;
    }

    /* Booth frame */
    .booth-frame {
      background: linear-gradient(145deg, #1a1a1a 0%, #0d0d0d 100%);
      padding: 16px;
      border-radius: 12px;
      box-shadow:
        0 20px 60px rgba(0, 0, 0, 0.25),
        inset 0 1px 0 rgba(255, 255, 255, 0.05);
      position: relative;
      overflow: hidden;
    }

    .booth-frame::before {
      content: '';
      position: absolute;
      top: 6px;
      left: 50%;
      transform: translateX(-50%);
      width: 8px;
      height: 8px;
      background: var(--rose);
      border-radius: 50%;
      box-shadow: 0 0 10px var(--rose);
      opacity: 0.8;
    }

    #video {
      width: 420px;
      height: 315px;
      object-fit: cover;
      border-radius: 6px;
      background: linear-gradient(135deg, #2a2a2a 0%, #1a1a1a 100%);
      display: block;
    }

    @media (max-width: 500px) {
      #video {
        width: 300px;
        height: 225px;
      }
    }

    /* Upload Zone */
    .upload-zone {
      width: 420px;
      height: 315px;
      border: 2px dashed var(--warm-beige);
      border-radius: 12px;
      background: linear-gradient(135deg, var(--beige) 0%, var(--cream) 100%);
      display: none;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      gap: 16px;
      cursor: pointer;
      transition: all 0.3s ease;
      position: relative;
      overflow: hidden;
    }

    .upload-zone::before {
      content: '';
      position: absolute;
      inset: 0;
      background: radial-gradient(circle at center, var(--rose-light) 0%, transparent 70%);
      opacity: 0;
      transition: opacity 0.3s ease;
    }

    .upload-zone:hover {
      border-color: var(--rose);
      background: linear-gradient(135deg, var(--cream) 0%, #fff 100%);
    }

    .upload-zone:hover::before {
      opacity: 0.05;
    }

    .upload-zone.drag-over {
      border-color: var(--rose);
      border-style: solid;
      background: linear-gradient(135deg, #fff 0%, var(--cream) 100%);
      transform: scale(1.01);
    }

    .upload-zone.drag-over::before {
      opacity: 0.1;
    }

    .upload-zone.active {
      display: flex;
    }

    .upload-icon {
      width: 64px;
      height: 64px;
      color: var(--warm-beige);
      transition: all 0.3s ease;
    }

    .upload-zone:hover .upload-icon {
      color: var(--rose);
      transform: translateY(-4px);
    }

    .upload-text {
      text-align: center;
    }

    .upload-text h3 {
      font-family: 'Cormorant Garamond', serif;
      font-size: 22px;
      font-weight: 600;
      color: var(--dark-brown);
      margin-bottom: 6px;
    }

    .upload-text p {
      font-size: 13px;
      color: var(--brown);
      opacity: 0.7;
    }

    .upload-btn-inline {
      padding: 12px 28px;
      font-family: 'Outfit', sans-serif;
      font-size: 12px;
      font-weight: 600;
      letter-spacing: 1px;
      text-transform: uppercase;
      color: var(--cream);
      background: var(--rose);
      border: none;
      border-radius: 50px;
      cursor: pointer;
      transition: all 0.2s ease;
      margin-top: 8px;
    }

    .upload-btn-inline:hover {
      background: var(--rose-dark);
      transform: translateY(-2px);
      box-shadow: 0 4px 15px rgba(158, 90, 99, 0.3);
    }

    @media (max-width: 500px) {
      .upload-zone {
        width: 300px;
        height: 225px;
      }
    }

    /* Hidden file input */
    #fileInput,
    #dropFileInput {
      display: none;
    }

    /* Capture button */
    .capture-btn {
      margin-top: 24px;
      padding: 16px 40px;
      font-family: 'Outfit', sans-serif;
      font-size: 13px;
      font-weight: 600;
      letter-spacing: 1.5px;
      text-transform: uppercase;
      color: var(--cream);
      background: linear-gradient(135deg, var(--rose) 0%, var(--rose-dark) 100%);
      border: none;
      border-radius: 50px;
      cursor: pointer;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      gap: 10px;
      box-shadow: 0 4px 20px rgba(158, 90, 99, 0.25);
    }

    .capture-btn:hover {
      transform: translateY(-3px);
      box-shadow: 0 8px 30px rgba(158, 90, 99, 0.35);
    }

    .capture-btn:disabled {
      opacity: 0.5;
      cursor: not-allowed;
      transform: none;
      box-shadow: none;
    }

    .capture-btn svg {
      width: 18px;
      height: 18px;
    }

    /* Photo strip container */
    .strip-container {
      margin-top: 40px;
      position: relative;
    }

    /* Kodak Portra style photo strip */
    .photo-strip {
      background: var(--film-white);
      width: 260px;
      position: relative;
      animation: stripSlide 0.5s cubic-bezier(0.34, 1.56, 0.64, 1);
      box-shadow:
        0 15px 50px rgba(0, 0, 0, 0.2),
        0 5px 15px rgba(0, 0, 0, 0.1);
      padding: 0;
    }

    @keyframes stripSlide {
      from {
        opacity: 0;
        transform: translateY(-30px) rotate(-2deg);
      }

      to {
        opacity: 1;
        transform: translateY(0) rotate(0);
      }
    }

    /* Film border - left side */
    .film-border-left {
      position: absolute;
      left: 0;
      top: 0;
      bottom: 0;
      width: 30px;
      background: var(--film-white);
      border-right: 1px solid #d5d0c5;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
      padding: 18px 0;
    }

    .film-text-vertical {
      writing-mode: vertical-rl;
      text-orientation: mixed;
      transform: rotate(180deg);
      font-family: 'Outfit', sans-serif;
      font-size: 7px;
      font-weight: 700;
      color: var(--black);
      letter-spacing: 1.5px;
      padding: 0 7px;
    }

    .frame-number-left {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 2px;
      padding: 8px 0;
    }

    .frame-arrow {
      font-size: 7px;
      color: var(--black);
    }

    .frame-num {
      font-family: 'Outfit', sans-serif;
      font-size: 10px;
      font-weight: 700;
      color: var(--black);
    }

    /* Film border - right side */
    .film-border-right {
      position: absolute;
      right: 0;
      top: 0;
      bottom: 0;
      width: 30px;
      background: var(--film-white);
      border-left: 1px solid #d5d0c5;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
      padding: 18px 0;
    }

    .film-text-right {
      writing-mode: vertical-rl;
      font-family: 'Outfit', sans-serif;
      font-size: 6px;
      font-weight: 500;
      color: var(--black);
      letter-spacing: 0.5px;
      padding: 0 6px;
    }

    .frame-number-right {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 2px;
      padding: 8px 0;
    }

    /* Film content area */
    .film-content {
      margin: 0 30px;
      padding: 14px 10px;
      background: var(--film-white);
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    /* Photo frames */
    .photo-frame {
      background: var(--black);
      aspect-ratio: 1/1;
      position: relative;
      overflow: visible;
      cursor: pointer;
      transition: all 0.2s ease;
      border-radius: 2px;
    }

    .photo-frame:hover {
      opacity: 0.95;
    }

    .photo-frame img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    .photo-frame.empty {
      background: linear-gradient(135deg, #1a1a1a 0%, #0a0a0a 100%);
      display: flex;
      align-items: center;
      justify-content: center;
      flex-direction: column;
      gap: 6px;
    }

    .photo-frame.empty::after {
      content: 'â™¥';
      font-size: 26px;
      color: #2a2a2a;
      transition: all 0.3s ease;
    }

    .photo-frame.empty:hover::after {
      color: var(--rose);
      opacity: 0.5;
    }

    .photo-frame.empty .upload-hint {
      font-family: 'Outfit', sans-serif;
      font-size: 8px;
      color: #3a3a3a;
      text-transform: uppercase;
      letter-spacing: 1.5px;
      transition: color 0.3s ease;
    }

    .photo-frame.empty:hover .upload-hint {
      color: #555;
    }

    .photo-frame.developing img {
      animation: develop 1.2s ease-out;
    }

    @keyframes develop {
      0% {
        filter: brightness(2) contrast(0.5) saturate(0) blur(8px);
      }

      50% {
        filter: brightness(1.2) contrast(0.8) saturate(0.5) blur(2px);
      }

      100% {
        filter: brightness(1) contrast(1) saturate(1) blur(0);
      }
    }

    /* Remove photo button */
    .remove-photo-btn {
      position: absolute;
      top: 6px;
      right: 6px;
      width: 22px;
      height: 22px;
      background: rgba(0, 0, 0, 0.75);
      color: white;
      border: none;
      border-radius: 50%;
      font-size: 14px;
      cursor: pointer;
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 5;
      transition: all 0.2s ease;
      backdrop-filter: blur(4px);
    }

    .photo-frame:hover .remove-photo-btn {
      display: flex;
    }

    .remove-photo-btn:hover {
      background: var(--rose);
      transform: scale(1.1);
    }

    /* Stickers on photo strip */
    .strip-sticker {
      position: absolute;
      width: 36px;
      height: 36px;
      cursor: move;
      z-index: 10;
      filter: drop-shadow(2px 2px 3px rgba(0, 0, 0, 0.35));
      transition: transform 0.15s ease;
    }

    .strip-sticker:hover {
      transform: scale(1.15);
    }

    .strip-sticker svg {
      width: 100%;
      height: 100%;
      pointer-events: none;
    }

    /* Download button */
    .download-btn {
      margin-top: 20px;
      padding: 12px 28px;
      font-family: 'Outfit', sans-serif;
      font-size: 11px;
      font-weight: 600;
      letter-spacing: 1.5px;
      text-transform: uppercase;
      color: var(--dark-brown);
      background: transparent;
      border: 1.5px solid var(--brown);
      border-radius: 50px;
      cursor: pointer;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .download-btn:hover {
      background: var(--brown);
      color: var(--cream);
      transform: translateY(-2px);
      box-shadow: 0 4px 15px rgba(92, 64, 51, 0.2);
    }

    .download-btn svg {
      width: 16px;
      height: 16px;
    }

    /* Sidebar */
    .sidebar {
      display: flex;
      flex-direction: column;
      gap: 24px;
    }

    /* Note Container */
    .note-container {
      position: relative;
      min-height: 380px;
    }

    /* Editable Note */
    .editable-note {
      background: #FFFEF9;
      border: 1px solid var(--warm-beige);
      border-radius: 8px;
      overflow: hidden;
      transition: all 0.5s ease;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.06);
    }

    .editable-note.hidden {
      opacity: 0;
      transform: scale(0.95);
      pointer-events: none;
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
    }

    .note-header {
      background: linear-gradient(135deg, var(--beige) 0%, #E8DFD0 100%);
      padding: 14px 18px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      border-bottom: 1px solid var(--warm-beige);
    }

    .note-title {
      font-family: 'Cormorant Garamond', serif;
      font-size: 16px;
      font-weight: 600;
      color: var(--dark-brown);
    }

    .note-icon {
      font-size: 18px;
    }

    .note-recipient {
      padding: 14px 18px;
      border-bottom: 1px dashed var(--warm-beige);
    }

    .note-recipient label {
      font-family: 'Special Elite', monospace;
      font-size: 11px;
      color: var(--brown);
      display: block;
      margin-bottom: 6px;
    }

    .note-recipient input {
      width: 100%;
      padding: 10px 0;
      font-family: 'Special Elite', monospace;
      font-size: 15px;
      color: var(--dark-brown);
      background: transparent;
      border: none;
      border-bottom: 1px solid var(--warm-beige);
      outline: none;
      transition: border-color 0.2s;
    }

    .note-recipient input:focus {
      border-bottom-color: var(--rose);
    }

    .note-body {
      padding: 18px;
    }

    .note-body label {
      font-family: 'Special Elite', monospace;
      font-size: 11px;
      color: var(--brown);
      display: block;
      margin-bottom: 10px;
    }

    .note-textarea {
      width: 100%;
      min-height: 110px;
      padding: 14px;
      font-family: 'Special Elite', monospace;
      font-size: 14px;
      line-height: 1.9;
      color: var(--dark-brown);
      background: linear-gradient(transparent, transparent 28px, #EDE8E0 28px);
      background-size: 100% 29px;
      border: 1px solid var(--warm-beige);
      border-radius: 6px;
      outline: none;
      resize: vertical;
      transition: border-color 0.2s, box-shadow 0.2s;
    }

    .note-textarea:focus {
      border-color: var(--rose);
      box-shadow: 0 0 0 3px rgba(158, 90, 99, 0.1);
    }

    .note-textarea::placeholder {
      color: #c5bdb0;
    }

    .note-footer {
      padding: 14px 18px;
      border-top: 1px dashed var(--warm-beige);
      display: flex;
      align-items: center;
      justify-content: space-between;
    }

    .note-footer label {
      font-family: 'Special Elite', monospace;
      font-size: 11px;
      color: var(--brown);
    }

    .note-footer input {
      padding: 8px 0;
      font-family: 'Special Elite', monospace;
      font-size: 14px;
      color: var(--rose);
      background: transparent;
      border: none;
      border-bottom: 1px solid var(--warm-beige);
      outline: none;
      text-align: right;
      width: 130px;
    }

    .note-footer input:focus {
      border-bottom-color: var(--rose);
    }

    /* Send button */
    .send-btn-container {
      padding: 18px;
      border-top: 1px solid var(--warm-beige);
    }

    .send-btn {
      width: 100%;
      padding: 15px 24px;
      font-family: 'Outfit', sans-serif;
      font-size: 12px;
      font-weight: 600;
      letter-spacing: 1.5px;
      text-transform: uppercase;
      color: var(--cream);
      background: linear-gradient(135deg, var(--rose) 0%, var(--rose-dark) 100%);
      border: none;
      border-radius: 50px;
      cursor: pointer;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
      box-shadow: 0 4px 15px rgba(158, 90, 99, 0.2);
    }

    .send-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 25px rgba(158, 90, 99, 0.3);
    }

    .send-btn:disabled {
      opacity: 0.5;
      cursor: not-allowed;
      transform: none;
    }

    /* Vintage Newspaper */
    .newspaper-note {
      background: #FFFEF9;
      border: 1.5px solid var(--black);
      position: relative;
      opacity: 0;
      transform: scale(0.95) rotate(-1deg);
      transition: all 0.5s ease;
      pointer-events: none;
      box-shadow: 0 8px 30px rgba(0, 0, 0, 0.12);
    }

    .newspaper-note.visible {
      opacity: 1;
      transform: scale(1) rotate(0);
      pointer-events: auto;
    }

    .newspaper-masthead {
      background: var(--black);
      color: var(--cream);
      text-align: center;
      padding: 12px 18px;
      font-family: 'Special Elite', monospace;
      font-size: 22px;
      letter-spacing: 5px;
      text-transform: uppercase;
    }

    .newspaper-dateline {
      text-align: center;
      padding: 10px;
      border-bottom: 3px double var(--black);
      font-family: 'Special Elite', monospace;
      font-size: 8px;
      letter-spacing: 2px;
      color: var(--brown);
      text-transform: uppercase;
    }

    .newspaper-headline {
      text-align: center;
      padding: 18px 18px 14px;
      font-family: 'Cormorant Garamond', serif;
      font-size: 18px;
      font-weight: 700;
      color: var(--black);
      text-transform: uppercase;
      letter-spacing: 0.5px;
      line-height: 1.3;
    }

    .newspaper-subhead {
      text-align: center;
      padding: 0 18px 14px;
      font-family: 'Cormorant Garamond', serif;
      font-size: 11px;
      color: var(--brown);
      font-style: italic;
      border-bottom: 1px solid var(--black);
    }

    .newspaper-article {
      padding: 18px;
      font-family: 'Special Elite', monospace;
      font-size: 11px;
      line-height: 2;
      color: var(--dark-brown);
      text-align: justify;
    }

    .newspaper-article .drop-cap {
      float: left;
      font-family: 'Cormorant Garamond', serif;
      font-size: 48px;
      line-height: 0.75;
      padding-right: 10px;
      padding-top: 6px;
      color: var(--black);
      font-weight: 700;
    }

    .newspaper-byline {
      padding: 14px 18px;
      font-family: 'Special Elite', monospace;
      font-size: 9px;
      text-align: right;
      color: var(--brown);
      border-top: 1px dashed var(--warm-beige);
      letter-spacing: 1px;
    }

    .newspaper-decoration {
      display: flex;
      justify-content: center;
      gap: 10px;
      padding: 10px;
      border-top: 1px solid var(--warm-beige);
    }

    .newspaper-decoration span {
      font-size: 14px;
      color: var(--rose);
    }

    /* Edit button */
    .edit-btn {
      position: absolute;
      top: 10px;
      right: 10px;
      padding: 7px 14px;
      font-family: 'Outfit', sans-serif;
      font-size: 10px;
      font-weight: 500;
      color: var(--brown);
      background: var(--beige);
      border: 1px solid var(--warm-beige);
      border-radius: 50px;
      cursor: pointer;
      transition: all 0.2s ease;
      z-index: 5;
    }

    .edit-btn:hover {
      background: var(--warm-beige);
      transform: translateY(-1px);
    }

    /* Stickers panel */
    .stickers-panel {
      background: linear-gradient(135deg, var(--beige) 0%, #E8DFD0 100%);
      padding: 22px;
      border-radius: 10px;
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.05);
    }

    .stickers-title {
      font-family: 'Outfit', sans-serif;
      font-size: 11px;
      font-weight: 600;
      letter-spacing: 2.5px;
      color: var(--brown);
      text-transform: uppercase;
      margin-bottom: 6px;
    }

    .stickers-hint {
      font-family: 'Outfit', sans-serif;
      font-size: 11px;
      color: var(--brown);
      opacity: 0.6;
      margin-bottom: 18px;
    }

    .stickers-grid {
      display: flex;
      gap: 12px;
      flex-wrap: wrap;
    }

    .sticker {
      width: 46px;
      height: 46px;
      cursor: grab;
      transition: all 0.2s ease;
      opacity: 0.85;
      user-select: none;
      touch-action: none;
      background: rgba(255, 255, 255, 0.5);
      border-radius: 8px;
      padding: 6px;
    }

    .sticker:hover {
      transform: scale(1.15) rotate(-5deg);
      opacity: 1;
      background: rgba(255, 255, 255, 0.8);
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
    }

    .sticker:active {
      cursor: grabbing;
    }

    .sticker.dragging {
      opacity: 0.4;
      transform: scale(0.9);
    }

    .sticker svg {
      width: 100%;
      height: 100%;
      pointer-events: none;
    }

    /* Drag ghost */
    .drag-ghost {
      position: fixed;
      pointer-events: none;
      z-index: 9999;
      width: 46px;
      height: 46px;
      opacity: 0.95;
      transform: translate(-50%, -50%) scale(1.3) rotate(-10deg);
    }

    .drag-ghost svg {
      width: 100%;
      height: 100%;
      filter: drop-shadow(3px 3px 6px rgba(0, 0, 0, 0.3));
    }

    /* Countdown overlay */
    .countdown-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.9);
      display: none;
      justify-content: center;
      align-items: center;
      z-index: 1000;
      backdrop-filter: blur(8px);
    }

    .countdown-overlay.active {
      display: flex;
    }

    .countdown-number {
      font-family: 'Cormorant Garamond', serif;
      font-size: 180px;
      font-weight: 300;
      color: var(--cream);
      animation: countPulse 1s ease-in-out;
      text-shadow: 0 0 60px rgba(158, 90, 99, 0.5);
    }

    @keyframes countPulse {
      0% {
        transform: scale(0.5);
        opacity: 0;
      }

      50% {
        transform: scale(1.1);
      }

      100% {
        transform: scale(1);
        opacity: 1;
      }
    }

    /* Flash effect */
    .flash {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: white;
      opacity: 0;
      pointer-events: none;
      z-index: 999;
    }

    .flash.active {
      animation: flashEffect 0.3s ease-out;
    }

    @keyframes flashEffect {
      0% {
        opacity: 1;
      }

      100% {
        opacity: 0;
      }
    }

    /* Footer */
    footer {
      text-align: center;
      padding: 40px 20px;
      border-top: 1px solid var(--warm-beige);
      margin-top: 40px;
      background: linear-gradient(180deg, transparent 0%, rgba(237, 230, 218, 0.3) 100%);
    }

    .footer-text {
      font-family: 'Cormorant Garamond', serif;
      font-size: 14px;
      font-weight: 400;
      font-style: italic;
      color: var(--brown);
      letter-spacing: 0.5px;
    }

    .footer-text span {
      color: var(--rose);
    }

    /* Hidden canvas */
    #canvas {
      display: none;
    }

    /* Drop zone highlight */
    .photo-strip.drop-active {
      outline: 2px dashed var(--rose);
      outline-offset: 6px;
    }

    /* Frame upload input */
    .frame-upload-input {
      display: none;
    }

    /* Camera not available message */
    .camera-unavailable {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      text-align: center;
      padding: 40px 20px;
      color: var(--brown);
    }

    .camera-unavailable svg {
      width: 48px;
      height: 48px;
      margin-bottom: 16px;
      opacity: 0.5;
    }

    .camera-unavailable h3 {
      font-family: 'Cormorant Garamond', serif;
      font-size: 18px;
      margin-bottom: 8px;
    }

    .camera-unavailable p {
      font-size: 13px;
      opacity: 0.7;
    }
  </style>
</head>

<body>
  <header>
    <h1><span>Valentines</span> <span>2026</span></h1>
    <p class="subtitle">Photo Booth</p>
    <div class="header-decoration">
      <span class="line"></span>
      <span class="heart">â™¥</span>
      <span class="line"></span>
    </div>
  </header>

  <main class="main-container">
    <section class="booth-section">
      <!-- Mode Selection Tabs -->
      <div class="mode-tabs">
        <button class="mode-tab active" id="cameraTab" data-mode="camera">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z" />
            <circle cx="12" cy="13" r="4" />
          </svg>
          Camera
        </button>
        <button class="mode-tab" id="uploadTab" data-mode="upload">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4" />
            <polyline points="17 8 12 3 7 8" />
            <line x1="12" y1="3" x2="12" y2="15" />
          </svg>
          Upload
        </button>
      </div>

      <div class="booth-frame" id="boothFrame">
        <video id="video" autoplay playsinline></video>
      </div>

      <!-- Upload Zone (shown when upload mode is active) -->
      <div class="upload-zone" id="uploadZone">
        <svg class="upload-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
          <rect x="3" y="3" width="18" height="18" rx="2" ry="2" />
          <circle cx="8.5" cy="8.5" r="1.5" />
          <polyline points="21 15 16 10 5 21" />
        </svg>
        <div class="upload-text">
          <h3>Drop your photos here</h3>
          <p>or click to browse (up to 3 images)</p>
        </div>
        <button class="upload-btn-inline" id="browseBtn">Choose Files</button>
        <input type="file" id="dropFileInput" accept="image/*" multiple>
      </div>

      <input type="file" id="fileInput" accept="image/*" multiple>

      <!-- Capture Button (shown in camera mode) -->
      <button class="capture-btn" id="captureBtn">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <circle cx="12" cy="12" r="10" />
          <circle cx="12" cy="12" r="4" fill="currentColor" />
        </svg>
        Take 3 Photos
      </button>

      <div class="strip-container" id="stripContainer" style="display: none;">
        <div class="photo-strip" id="photoStrip">
          <!-- Left film border -->
          <div class="film-border-left">
            <div class="frame-number-left">
              <span class="frame-arrow">â–²</span>
              <span class="frame-num">42</span>
            </div>
            <span class="film-text-vertical">KODAK 400</span>
            <div class="frame-number-left">
              <span class="frame-arrow">â–²</span>
              <span class="frame-num">43</span>
            </div>
            <span class="film-text-vertical">KODAK 400</span>
            <div class="frame-number-left">
              <span class="frame-arrow">â–²</span>
              <span class="frame-num">44</span>
            </div>
          </div>

          <!-- Right film border -->
          <div class="film-border-right">
            <div class="frame-number-right">
              <span class="frame-num">11</span>
              <span class="frame-arrow">â–²</span>
            </div>
            <span class="film-text-right">KODAK PORTRA</span>
            <div class="frame-number-right">
              <span class="frame-num">12</span>
              <span class="frame-arrow">â–²</span>
            </div>
            <span class="film-text-right">PP 1 5003TX</span>
            <div class="frame-number-right">
              <span class="frame-num">13</span>
              <span class="frame-arrow">â–²</span>
            </div>
          </div>

          <!-- Film content -->
          <div class="film-content" id="filmContent">
            <div class="photo-frame empty" id="frame1" data-frame="1">
              <span class="upload-hint">Click to add</span>
              <input type="file" class="frame-upload-input" accept="image/*" data-frame="1">
            </div>
            <div class="photo-frame empty" id="frame2" data-frame="2">
              <span class="upload-hint">Click to add</span>
              <input type="file" class="frame-upload-input" accept="image/*" data-frame="2">
            </div>
            <div class="photo-frame empty" id="frame3" data-frame="3">
              <span class="upload-hint">Click to add</span>
              <input type="file" class="frame-upload-input" accept="image/*" data-frame="3">
            </div>
          </div>
        </div>
      </div>
      <button class="download-btn" id="downloadBtn" style="display: none;">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4" />
          <polyline points="7 10 12 15 17 10" />
          <line x1="12" y1="15" x2="12" y2="3" />
        </svg>
        Save Photo Strip
      </button>
    </section>

    <aside class="sidebar">
      <!-- Note Container -->
      <div class="note-container">
        <!-- Editable Note -->
        <div class="editable-note" id="editableNote">
          <div class="note-header">
            <span class="note-title">Your Love Letter</span>
            <span class="note-icon">ðŸ’Œ</span>
          </div>
          <div class="note-recipient">
            <label>To:</label>
            <input type="text" id="noteTo" placeholder="My Dearest...">
          </div>
          <div class="note-body">
            <label>Your Message:</label>
            <textarea class="note-textarea" id="noteMessage" placeholder="Write your heartfelt message here..."></textarea>
          </div>
          <div class="note-footer">
            <label>With love,</label>
            <input type="text" id="noteFrom" placeholder="Your name">
          </div>
          <div class="send-btn-container">
            <button class="send-btn" id="sendBtn">
              <span>Send Letter</span>
              <span>ðŸ’•</span>
            </button>
          </div>
        </div>

        <!-- Newspaper Style (after send) -->
        <div class="newspaper-note" id="newspaperNote">
          <button class="edit-btn" id="editBtn">âœŽ Edit</button>
          <div class="newspaper-masthead">The Love Gazette</div>
          <div class="newspaper-dateline">Vol. LXXVI â€¢ February 14, 2026 â€¢ Special Valentine's Edition</div>
          <div class="newspaper-headline" id="newspaperHeadline">A Message of Love Delivered</div>
          <div class="newspaper-subhead" id="newspaperSubhead">A heartfelt declaration reaches its beloved recipient</div>
          <div class="newspaper-article" id="newspaperArticle">
            <span class="drop-cap">T</span>oday marks a momentous occasion...
          </div>
          <div class="newspaper-byline" id="newspaperByline">â€” Written with love</div>
          <div class="newspaper-decoration">
            <span>â™¥</span>
            <span>â™¥</span>
            <span>â™¥</span>
          </div>
        </div>
      </div>

      <!-- Stickers Panel -->
      <div class="stickers-panel">
        <div class="stickers-title">Valentine Charms</div>
        <div class="stickers-hint">Drag onto your photo strip â€¢ Double-click to remove</div>
        <div class="stickers-grid" id="stickersGrid">
          <div class="sticker" data-sticker="heart-rose" draggable="true">
            <svg viewBox="0 0 24 24" fill="#9E5A63">
              <path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z" />
            </svg>
          </div>
          <div class="sticker" data-sticker="heart-brown" draggable="true">
            <svg viewBox="0 0 24 24" fill="#5C4033">
              <path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z" />
            </svg>
          </div>
          <div class="sticker" data-sticker="heart-beige" draggable="true">
            <svg viewBox="0 0 24 24" fill="#D4C4B0">
              <path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z" />
            </svg>
          </div>
          <div class="sticker" data-sticker="heart-outline" draggable="true">
            <svg viewBox="0 0 24 24" fill="none" stroke="#9E5A63" stroke-width="2">
              <path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z" />
            </svg>
          </div>
          <div class="sticker" data-sticker="heart-dark" draggable="true">
            <svg viewBox="0 0 24 24" fill="#3D2914">
              <path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z" />
            </svg>
          </div>
          <div class="sticker" data-sticker="star" draggable="true">
            <svg viewBox="0 0 24 24" fill="#B8997A">
              <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z" />
            </svg>
          </div>
          <div class="sticker" data-sticker="kiss" draggable="true">
            <svg viewBox="0 0 24 24" fill="#D4C4B0">
              <ellipse cx="12" cy="14" rx="8" ry="5" />
              <ellipse cx="8" cy="13" rx="3" ry="2" />
              <ellipse cx="16" cy="13" rx="3" ry="2" />
              <path d="M12 17c-1 0-2-.5-2-1s1-1 2-1 2 .5 2 1-1 1-2 1z" fill="#9E5A63" />
            </svg>
          </div>
          <div class="sticker" data-sticker="arrow" draggable="true">
            <svg viewBox="0 0 24 24" fill="none" stroke="#5C4033" stroke-width="1.5">
              <path d="M2 12h20M18 8l4 4-4 4" />
              <path d="M7 7l-3 5 3 5" fill="#9E5A63" />
            </svg>
          </div>
        </div>
      </div>
    </aside>
  </main>

  <!-- Countdown Overlay -->
  <div class="countdown-overlay" id="countdown">
    <span class="countdown-number" id="countdownNumber">3</span>
  </div>

  <!-- Flash Effect -->
  <div class="flash" id="flash"></div>

  <!-- Hidden Canvas -->
  <canvas id="canvas"></canvas>

  <footer>
    <p class="footer-text">Made with <span>â™¥</span> for Valentines 2026</p>
  </footer>

  <script>
    const video = document.getElementById('video');
    const canvas = document.getElementById('canvas');
    const ctx = canvas.getContext('2d');
    const captureBtn = document.getElementById('captureBtn');
    const fileInput = document.getElementById('fileInput');
    const dropFileInput = document.getElementById('dropFileInput');
    const stripContainer = document.getElementById('stripContainer');
    const photoStrip = document.getElementById('photoStrip');
    const filmContent = document.getElementById('filmContent');
    const downloadBtn = document.getElementById('downloadBtn');
    const countdown = document.getElementById('countdown');
    const countdownNumber = document.getElementById('countdownNumber');
    const flash = document.getElementById('flash');
    const stickersGrid = document.getElementById('stickersGrid');
    // Mode tabs
    const cameraTab = document.getElementById('cameraTab');
    const uploadTab = document.getElementById('uploadTab');
    const boothFrame = document.getElementById('boothFrame');
    const uploadZone = document.getElementById('uploadZone');
    const browseBtn = document.getElementById('browseBtn');
    // Note elements
    const editableNote = document.getElementById('editableNote');
    const newspaperNote = document.getElementById('newspaperNote');
    const sendBtn = document.getElementById('sendBtn');
    const editBtn = document.getElementById('editBtn');
    const noteTo = document.getElementById('noteTo');
    const noteMessage = document.getElementById('noteMessage');
    const noteFrom = document.getElementById('noteFrom');
    let photos = [null, null, null];
    let stream = null;
    let placedStickers = [];
    let dragGhost = null;
    let currentDragSticker = null;
    let currentMode = 'camera';
    // Mode switching
    function switchMode(mode) {
      currentMode = mode;
      if (mode === 'camera') {
        cameraTab.classList.add('active');
        uploadTab.classList.remove('active');
        boothFrame.style.display = 'block';
        uploadZone.classList.remove('active');
        captureBtn.style.display = 'flex';
        initCamera();
      } else {
        uploadTab.classList.add('active');
        cameraTab.classList.remove('active');
        boothFrame.style.display = 'none';
        uploadZone.classList.add('active');
        captureBtn.style.display = 'none';
        if (stream) {
          stream.getTracks().forEach(track => track.stop());
          stream = null;
        }
      }
    }
    cameraTab.addEventListener('click', () => switchMode('camera'));
    uploadTab.addEventListener('click', () => switchMode('upload'));
    // Upload zone interactions
    browseBtn.addEventListener('click', (e) => {
      e.stopPropagation();
      dropFileInput.click();
    });
    uploadZone.addEventListener('click', () => {
      dropFileInput.click();
    });
    // Drag and drop for upload zone
    uploadZone.addEventListener('dragover', (e) => {
      e.preventDefault();
      uploadZone.classList.add('drag-over');
    });
    uploadZone.addEventListener('dragleave', (e) => {
      e.preventDefault();
      uploadZone.classList.remove('drag-over');
    });
    uploadZone.addEventListener('drop', (e) => {
      e.preventDefault();
      uploadZone.classList.remove('drag-over');
      const files = Array.from(e.dataTransfer.files).filter(f => f.type.startsWith('image/')).slice(0, 3);
      if (files.length > 0) {
        handleFileUpload(files);
      }
    });
    dropFileInput.addEventListener('change', (e) => {
      const files = Array.from(e.target.files).slice(0, 3);
      if (files.length > 0) {
        handleFileUpload(files);
      }
      dropFileInput.value = '';
    });

    function handleFileUpload(files) {
      stripContainer.style.display = 'block';
      placedStickers = [];
      document.querySelectorAll('.strip-sticker').forEach(s => s.remove());
      // Reset frames first
      for (let i = 1; i <= 3; i++) {
        removePhoto(i);
      }
      photoStrip.style.animation = 'none';
      photoStrip.offsetHeight;
      photoStrip.style.animation = 'stripSlide 0.5s cubic-bezier(0.34, 1.56, 0.64, 1)';
      files.forEach((file, index) => {
        if (index >= 3) return;
        const reader = new FileReader();
        reader.onload = (event) => {
          photos[index] = event.target.result;
          displayPhoto(event.target.result, index + 1);
        };
        reader.readAsDataURL(file);
      });
    }
    async function initCamera() {
      try {
        stream = await navigator.mediaDevices.getUserMedia({
          video: {
            width: {
              ideal: 640
            },
            height: {
              ideal: 480
            },
            facingMode: 'user'
          }
        });
        video.srcObject = stream;
      } catch (err) {
        console.error('Camera error:', err);
        // Show upload mode if camera fails
        switchMode('upload');
      }
    }

    function showCountdown(num) {
      return new Promise(resolve => {
        countdown.classList.add('active');
        countdownNumber.textContent = num;
        countdownNumber.style.animation = 'none';
        countdownNumber.offsetHeight;
        countdownNumber.style.animation = 'countPulse 1s ease-in-out';
        setTimeout(() => {
          if (num > 1) {
            showCountdown(num - 1).then(resolve);
          } else {
            countdown.classList.remove('active');
            resolve();
          }
        }, 1000);
      });
    }

    function triggerFlash() {
      flash.classList.add('active');
      setTimeout(() => flash.classList.remove('active'), 300);
    }

    function capturePhoto() {
      canvas.width = video.videoWidth;
      canvas.height = video.videoHeight;
      ctx.translate(canvas.width, 0);
      ctx.scale(-1, 1);
      ctx.drawImage(video, 0, 0);
      ctx.setTransform(1, 0, 0, 1, 0, 0);
      return canvas.toDataURL('image/jpeg', 0.92);
    }

    function displayPhoto(photoData, frameNum) {
      const frame = document.getElementById(`frame${frameNum}`);
      frame.classList.remove('empty');
      frame.classList.add('developing');
      const hint = frame.querySelector('.upload-hint');
      if (hint) hint.remove();
      const fileInputEl = frame.querySelector('.frame-upload-input');
      frame.innerHTML = '';
      const img = document.createElement('img');
      img.src = photoData;
      img.alt = `Photo ${frameNum}`;
      frame.appendChild(img);
      const removeBtn = document.createElement('button');
      removeBtn.className = 'remove-photo-btn';
      removeBtn.innerHTML = 'Ã—';
      removeBtn.onclick = (e) => {
        e.stopPropagation();
        removePhoto(frameNum);
      };
      frame.appendChild(removeBtn);
      if (fileInputEl) {
        frame.appendChild(fileInputEl);
      }
      updateDownloadButton();
    }

    function removePhoto(frameNum) {
      photos[frameNum - 1] = null;
      const frame = document.getElementById(`frame${frameNum}`);
      frame.classList.add('empty');
      frame.classList.remove('developing');
      const fileInputEl = frame.querySelector('.frame-upload-input');
      frame.innerHTML = '';
      const hint = document.createElement('span');
      hint.className = 'upload-hint';
      hint.textContent = 'Click to add';
      frame.appendChild(hint);
      if (fileInputEl) {
        fileInputEl.value = '';
        frame.appendChild(fileInputEl);
      }
      updateDownloadButton();
    }

    function updateDownloadButton() {
      const hasPhotos = photos.some(p => p !== null);
      downloadBtn.style.display = hasPhotos ? 'flex' : 'none';
    }
    async function takePhotos() {
      photos = [null, null, null];
      placedStickers = [];
      document.querySelectorAll('.strip-sticker').forEach(s => s.remove());
      captureBtn.disabled = true;
      stripContainer.style.display = 'block';
      downloadBtn.style.display = 'none';
      for (let i = 1; i <= 3; i++) {
        removePhoto(i);
      }
      photoStrip.style.animation = 'none';
      photoStrip.offsetHeight;
      photoStrip.style.animation = 'stripSlide 0.5s cubic-bezier(0.34, 1.56, 0.64, 1)';
      for (let i = 1; i <= 3; i++) {
        await showCountdown(3);
        triggerFlash();
        const photo = capturePhoto();
        photos[i - 1] = photo;
        displayPhoto(photo, i);
        if (i < 3) {
          await new Promise(resolve => setTimeout(resolve, 600));
        }
      }
      captureBtn.disabled = false;
    }
    // Individual frame click to upload
    function initFrameUploads() {
      for (let i = 1; i <= 3; i++) {
        const frame = document.getElementById(`frame${i}`);
        const frameInput = frame.querySelector('.frame-upload-input');
        frame.addEventListener('click', (e) => {
          if (e.target.classList.contains('remove-photo-btn')) return;
          stripContainer.style.display = 'block';
          frameInput.click();
        });
        frameInput.addEventListener('change', (e) => {
          const file = e.target.files[0];
          if (!file) return;
          const frameNum = parseInt(frameInput.dataset.frame);
          const reader = new FileReader();
          reader.onload = (event) => {
            photos[frameNum - 1] = event.target.result;
            displayPhoto(event.target.result, frameNum);
          };
          reader.readAsDataURL(file);
          frameInput.value = '';
        });
      }
    }
    // Send letter function
    function sendLetter() {
      const to = noteTo.value.trim() || 'My Dearest';
      const message = noteMessage.value.trim() || 'Words cannot express the depth of my feelings for you.';
      const from = noteFrom.value.trim() || 'Your Secret Admirer';
      document.getElementById('newspaperHeadline').textContent = `A Love Letter to ${to}`;
      document.getElementById('newspaperSubhead').textContent = `A heartfelt declaration from ${from} reaches its beloved recipient`;
      const firstLetter = message.charAt(0).toUpperCase();
      const restOfMessage = message.slice(1);
      document.getElementById('newspaperArticle').innerHTML =
        `<span class="drop-cap">${firstLetter}</span>${restOfMessage}`;
      document.getElementById('newspaperByline').textContent = `â€” With all my love, ${from}`;
      editableNote.classList.add('hidden');
      setTimeout(() => {
        newspaperNote.classList.add('visible');
      }, 300);
    }

    function editLetter() {
      newspaperNote.classList.remove('visible');
      setTimeout(() => {
        editableNote.classList.remove('hidden');
      }, 300);
    }
    sendBtn.addEventListener('click', sendLetter);
    editBtn.addEventListener('click', editLetter);
    // Sticker drag and drop functionality
    function initStickers() {
      const stickers = document.querySelectorAll('.sticker');
      stickers.forEach(sticker => {
        sticker.addEventListener('mousedown', startDrag);
        sticker.addEventListener('touchstart', startDrag, {
          passive: false
        });
      });
      document.addEventListener('mousemove', onDrag);
      document.addEventListener('touchmove', onDrag, {
        passive: false
      });
      document.addEventListener('mouseup', endDrag);
      document.addEventListener('touchend', endDrag);
    }

    function startDrag(e) {
      e.preventDefault();
      const sticker = e.currentTarget;
      currentDragSticker = sticker;
      sticker.classList.add('dragging');
      dragGhost = document.createElement('div');
      dragGhost.className = 'drag-ghost';
      dragGhost.innerHTML = sticker.innerHTML;
      dragGhost.dataset.sticker = sticker.dataset.sticker;
      document.body.appendChild(dragGhost);
      const pos = getEventPos(e);
      dragGhost.style.left = pos.x + 'px';
      dragGhost.style.top = pos.y + 'px';
      photoStrip.classList.add('drop-active');
    }

    function onDrag(e) {
      if (!dragGhost) return;
      e.preventDefault();
      const pos = getEventPos(e);
      dragGhost.style.left = pos.x + 'px';
      dragGhost.style.top = pos.y + 'px';
    }

    function endDrag(e) {
      if (!dragGhost || !currentDragSticker) return;
      const pos = getEventPos(e);
      const stripRect = photoStrip.getBoundingClientRect();
      if (pos.x >= stripRect.left && pos.x <= stripRect.right &&
        pos.y >= stripRect.top && pos.y <= stripRect.bottom) {
        const relX = pos.x - stripRect.left;
        const relY = pos.y - stripRect.top;
        const placedSticker = document.createElement('div');
        placedSticker.className = 'strip-sticker';
        placedSticker.innerHTML = dragGhost.innerHTML;
        placedSticker.style.left = (relX - 18) + 'px';
        placedSticker.style.top = (relY - 18) + 'px';
        const stickerData = {
          html: dragGhost.innerHTML,
          x: relX - 18,
          y: relY - 18,
          type: dragGhost.dataset.sticker
        };
        placedStickers.push(stickerData);
        makePlacedStickerDraggable(placedSticker, stickerData);
        placedSticker.addEventListener('dblclick', () => {
          const index = placedStickers.indexOf(stickerData);
          if (index > -1) placedStickers.splice(index, 1);
          placedSticker.remove();
        });
        photoStrip.appendChild(placedSticker);
      }
      currentDragSticker.classList.remove('dragging');
      currentDragSticker = null;
      dragGhost.remove();
      dragGhost = null;
      photoStrip.classList.remove('drop-active');
    }

    function makePlacedStickerDraggable(element, stickerData) {
      let isDragging = false;
      let startX, startY, initialX, initialY;
      element.addEventListener('mousedown', startPlacedDrag);
      element.addEventListener('touchstart', startPlacedDrag, {
        passive: false
      });

      function startPlacedDrag(e) {
        if (e.type === 'touchstart') e.preventDefault();
        isDragging = true;
        const pos = getEventPos(e);
        startX = pos.x;
        startY = pos.y;
        initialX = element.offsetLeft;
        initialY = element.offsetTop;
        document.addEventListener('mousemove', onPlacedDrag);
        document.addEventListener('touchmove', onPlacedDrag, {
          passive: false
        });
        document.addEventListener('mouseup', endPlacedDrag);
        document.addEventListener('touchend', endPlacedDrag);
      }

      function onPlacedDrag(e) {
        if (!isDragging) return;
        e.preventDefault();
        const pos = getEventPos(e);
        const dx = pos.x - startX;
        const dy = pos.y - startY;
        const newX = initialX + dx;
        const newY = initialY + dy;
        element.style.left = newX + 'px';
        element.style.top = newY + 'px';
        stickerData.x = newX;
        stickerData.y = newY;
      }

      function endPlacedDrag() {
        isDragging = false;
        document.removeEventListener('mousemove', onPlacedDrag);
        document.removeEventListener('touchmove', onPlacedDrag);
        document.removeEventListener('mouseup', endPlacedDrag);
        document.removeEventListener('touchend', endPlacedDrag);
      }
    }

    function getEventPos(e) {
      if (e.touches && e.touches.length > 0) {
        return {
          x: e.touches[0].clientX,
          y: e.touches[0].clientY
        };
      } else if (e.changedTouches && e.changedTouches.length > 0) {
        return {
          x: e.changedTouches[0].clientX,
          y: e.changedTouches[0].clientY
        };
      }
      return {
        x: e.clientX,
        y: e.clientY
      };
    }

    function downloadStrip() {
      const stripCanvas = document.createElement('canvas');
      const stripCtx = stripCanvas.getContext('2d');
      const borderWidth = 65;
      const frameSize = 420;
      const frameGap = 24;
      const padding = 28;
      const totalWidth = borderWidth + frameSize + borderWidth;
      const totalHeight = (frameSize * 3) + (frameGap * 2) + (padding * 2);
      stripCanvas.width = totalWidth;
      stripCanvas.height = totalHeight;
      stripCtx.fillStyle = '#F5F2EB';
      stripCtx.fillRect(0, 0, totalWidth, totalHeight);
      stripCtx.strokeStyle = '#d5d0c5';
      stripCtx.lineWidth = 1;
      stripCtx.beginPath();
      stripCtx.moveTo(borderWidth, 0);
      stripCtx.lineTo(borderWidth, totalHeight);
      stripCtx.stroke();
      stripCtx.beginPath();
      stripCtx.moveTo(totalWidth - borderWidth, 0);
      stripCtx.lineTo(totalWidth - borderWidth, totalHeight);
      stripCtx.stroke();
      stripCtx.fillStyle = '#1A1A1A';
      stripCtx.font = 'bold 16px "Outfit", sans-serif';
      stripCtx.textAlign = 'center';
      const frameNumbers = [42, 43, 44];
      frameNumbers.forEach((num, i) => {
        const y = padding + (i * (frameSize + frameGap)) + 35;
        stripCtx.fillText('â–²', borderWidth / 2, y);
        stripCtx.fillText(num.toString(), borderWidth / 2, y + 20);
      });
      stripCtx.save();
      stripCtx.translate(22, totalHeight / 3);
      stripCtx.rotate(-Math.PI / 2);
      stripCtx.font = 'bold 14px "Outfit", sans-serif';
      stripCtx.letterSpacing = '2px';
      stripCtx.fillText('KODAK 400', 0, 0);
      stripCtx.restore();
      stripCtx.save();
      stripCtx.translate(22, totalHeight * 2 / 3 + 55);
      stripCtx.rotate(-Math.PI / 2);
      stripCtx.fillText('KODAK 400', 0, 0);
      stripCtx.restore();
      const rightNumbers = [11, 12, 13];
      rightNumbers.forEach((num, i) => {
        const y = padding + (i * (frameSize + frameGap)) + frameSize - 35;
        stripCtx.fillText(num.toString(), totalWidth - borderWidth / 2, y);
        stripCtx.fillText('â–²', totalWidth - borderWidth / 2, y + 17);
      });
      stripCtx.save();
      stripCtx.translate(totalWidth - 22, totalHeight / 3 + 55);
      stripCtx.rotate(Math.PI / 2);
      stripCtx.font = '12px "Outfit", sans-serif';
      stripCtx.fillText('KODAK PORTRA', 0, 0);
      stripCtx.restore();
      stripCtx.save();
      stripCtx.translate(totalWidth - 22, totalHeight * 2 / 3 + 85);
      stripCtx.rotate(Math.PI / 2);
      stripCtx.fillText('PP 1 5003TX', 0, 0);
      stripCtx.restore();
      const validPhotos = photos.filter(p => p !== null);
      const loadPromises = validPhotos.map((photo, index) => {
        return new Promise(resolve => {
          const img = new Image();
          img.onload = () => {
            const x = borderWidth;
            const y = padding + (index * (frameSize + frameGap));
            stripCtx.fillStyle = '#1A1A1A';
            stripCtx.fillRect(x, y, frameSize, frameSize);
            const size = Math.min(img.width, img.height);
            const sx = (img.width - size) / 2;
            const sy = (img.height - size) / 2;
            stripCtx.drawImage(img, sx, sy, size, size, x, y, frameSize, frameSize);
            resolve();
          };
          img.src = photo;
        });
      });
      for (let i = validPhotos.length; i < 3; i++) {
        const x = borderWidth;
        const y = padding + (i * (frameSize + frameGap));
        stripCtx.fillStyle = '#1A1A1A';
        stripCtx.fillRect(x, y, frameSize, frameSize);
      }
      Promise.all(loadPromises).then(() => {
        const displayWidth = 260;
        const scale = totalWidth / displayWidth;
        const stickerPromises = placedStickers.map(sticker => {
          return new Promise(resolve => {
            const svgData = sticker.html;
            const svgBlob = new Blob([svgData], {
              type: 'image/svg+xml'
            });
            const url = URL.createObjectURL(svgBlob);
            const img = new Image();
            img.onload = () => {
              const stickerSize = 36 * scale;
              const x = sticker.x * scale;
              const y = sticker.y * scale;
              stripCtx.drawImage(img, x, y, stickerSize, stickerSize);
              URL.revokeObjectURL(url);
              resolve();
            };
            img.onerror = resolve;
            img.src = url;
          });
        });
        Promise.all(stickerPromises).then(() => {
          const link = document.createElement('a');
          link.download = 'valentines-2026-photobooth.jpg';
          link.href = stripCanvas.toDataURL('image/jpeg', 0.95);
          link.click();
        });
      });
    }
    captureBtn.addEventListener('click', takePhotos);
    downloadBtn.addEventListener('click', downloadStrip);
    initCamera();
    initStickers();
    initFrameUploads();
  </script>
</body>

</html>
    
  </body>
  
</html>
